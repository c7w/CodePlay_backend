{"version":3,"sources":["store.tsx","components/Creator/Creator.tsx","components/Creator/SketchList/SketchList.tsx","components/Explorer/Explorer.tsx","components/HistoryList/HistoryList.tsx","components/Creator/ColorEditor/WorkSpace/ColorButton.tsx","components/Creator/ColorEditor/WorkSpace/ColorSlider.tsx","components/Creator/ColorEditor/WorkSpace/ColorPicker.tsx","components/Creator/ColorEditor/ColorEditor.tsx","utils/MD5.js","utils/Network.tsx","components/Navbar/Navbar.tsx","components/MainPage/MainPage.tsx","index.tsx","utils/Color.tsx","Settings.tsx","components/Creator/ColorEditor/WorkSpace/Preview.tsx"],"names":["colorEditorSlice","createSlice","name","initialState","colorState","currColorIndex","reducers","updateColorState","state","action","payload","updateCurrColorIndex","colorPickerSlice","updatePickerState","creatorSlice","sketchId","updateSketchId","mainPageSlice","userInfo","loggedIn","student_id","fullname","email","role","schemeList","sketchList","exploreScheme","misc","sortStrategy","approved","page","updateMainPageState","actions","getColorState","colorEditor","getCurrColorIndex","getPickerState","colorPicker","getCreatorSketchId","creator","getMainPageState","mainPage","configureStore","reducer","Creator","props","useSelector","dispatch","useDispatch","useState","init","setInit","getInitColorValue","eval","JSON","parse","sketch","sketch_list","filter","id","defaultValue","map","list","RGB_","String2ArrayRGB","RGBList","fullList","RGB2HSV","useEffect","getSketch","data","className","sketch_id","initColorValue","onSubmit","str","onClickSketch","scrollTo","ChooseSketch","pre_id","i","this","render","rawList","newColorArray","scratch_num","length","row","Math","trunc","all_items","inside_arr","j","index","scratch_data","push","placement","title","color","arrowPointAtCenter","style","margin","cursor","backgroundColor","borderRadius","padding","onClick","handler","raw_str","color_arr","min","React","Component","Explorer","mainPageState","getExploreRawSvg","filtered","refreshExplore","getExploreScheme","then","resp","schemes","newScheme","floor","random","switchPage","refresh","vote","changeUserScheme","err","message","error","success","unvote","approve","newExploreScheme","stringify","like","liked","likes","next","edit","colors","console","debug","download","color_num","my_color","color_saved","tmp","toString","padStart","svg","replaceAll","urlObject","window","URL","webkitURL","export_blob","Blob","save_link","document","createElementNS","href","createObjectURL","obj","ev","createEvent","initMouseEvent","dispatchEvent","fakeClick","exportRaw","disabled","value","addonBefore","textAlign","autoSize","minRows","maxRows","description","userSelect","fontSize","display","justifyContent","alignItems","undefined","marginLeft","Piece","ifapproved","ifapprove","disapprove","setState","color_bind","tmp_str","color_str","opacity","select","ifhide","icon","faCheckCircle","explore","author","pic_name","HistoryList","currSketchId","arr_left","arr_right","s","getString","parjson","scheme","num","left_num","p","pic_class","show_select","mycolor","hidden","r","g","b","a","delete","shape","sort","flexGrow","ColorButton","boxShadow","selected","ColorSlider","onChange","colorGradient","propsString","span","max","step","trackStyle","railStyle","backgroundImage","ColorPicker","colorPickerState","setName","setDescription","colorOnChange","colorArrayBefore","colorArrayAfter","HSV2RGB","initColor","placeholder","allowClear","event","target","rows","type","htmlType","ColorEditor","setSketch","buttonList","Preview","newColorState","slice","MD5","string","RotateLeft","lValue","iShiftBits","AddUnsigned","lX","lY","lX4","lY4","lX8","lY8","lResult","FF","c","d","x","ac","y","z","F","GG","G","HH","H","II","I","WordToHex","lCount","WordToHexValue","WordToHexValue_temp","substr","k","AA","BB","CC","DD","Array","replace","utftext","n","charCodeAt","String","fromCharCode","Utf8Encode","lWordCount","lMessageLength","lNumberOfWords_temp1","lNumberOfWords","lWordArray","lBytePosition","lByteCount","ConvertToWordArray","toLowerCase","getSessionId","cookie","split","trim","indexOf","substring","promptToDesigner","key","md5","sessionId","log","parameter","urlbasic","WEB_URL","fetch","method","headers","body","json","status","operation","recordId","recordName","descrption","author_Id","sessionid","author_id","url","catch","sort_strategy","TopBar","submittedIn30s","MainPage","config","maxCount","updatePage","setUpdatePage","changeSort","approvedOnly","currApprovedOnly","newMisc","stateChangeFunction","color_List","info","setTimeout","centered","visible","onCancel","footer","ReactDOM","StrictMode","store","getElementById","colorValueListBak","R","B","S","V","h","f","q","t","parseFloat","toFixed","colorMax","getMax","colorMin","getMin","delta","colorHexString","parseInt","dangerouslySetInnerHTML","__html"],"mappings":"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","file":"static/js/main.78a154e3.chunk.js","sourcesContent":["import { configureStore, createSlice } from '@reduxjs/toolkit';\r\n\r\n\r\nconst colorEditorSlice = createSlice({\r\n    name: 'ColorEditor',\r\n    initialState: {\r\n        colorState: [\r\n            [255,255,255,1,0,0,0], \r\n            [255,255,255,1,0,0,0],\r\n            [255,255,255,1,0,0,0],\r\n            [255,255,255,1,0,0,0],\r\n            [255,255,255,1,0,0,0],\r\n            [255,255,255,1,0,0,0],\r\n            [255,255,255,1,0,0,0],\r\n            [255,255,255,1,0,0,0],\r\n            [255,255,255,1,0,0,0],\r\n            [255,255,255,1,0,0,0],\r\n        ],\r\n        currColorIndex: 0\r\n    },\r\n    reducers: {\r\n        updateColorState: (state, action) =>{\r\n            state.colorState = action.payload;\r\n        },\r\n        updateCurrColorIndex: (state, action) => {\r\n            state.currColorIndex = action.payload;\r\n        }\r\n    }\r\n});\r\n\r\nconst colorPickerSlice = createSlice({\r\n    name: 'ColorPicker',\r\n    initialState: {\r\n        colorState: [255,255,255,1,0,0,0],\r\n    },\r\n    reducers: {\r\n        updatePickerState: (state, action) => {state.colorState = action.payload; }\r\n    }\r\n});\r\n\r\nconst creatorSlice = createSlice({\r\n    name: 'Creator',\r\n    initialState: {\r\n        sketchId: 1,\r\n    },\r\n    reducers: {\r\n        updateSketchId: (state, action) => {state.sketchId = action.payload},\r\n    }\r\n});\r\n\r\nconst mainPageSlice = createSlice({\r\n    name: 'MainPage',\r\n    initialState: {\r\n        state:{\r\n            userInfo: {\r\n                loggedIn: false,\r\n                student_id: 0,\r\n                name: '',\r\n                fullname: '',\r\n                email: '',\r\n                role: '',\r\n            },\r\n            schemeList: {\r\n                \"schemes\": [\r\n                    {\"id\":87,\"liked\": false, \"submission_time\":1633797634,\"sketch_id\":1,\"name\":\"RuntimeErrrorrr\",\"description\":\"CodeGOGOOGOGOGOGO\",\"likes\":14,\"approved\":true,\"author\":{\"student_id\":2020010951,\"name\":\"cc7w\",\"fullname\":\"网络出问题啦~\",\"email\":\"gha@mails.tsinghua.edu.cn\",\"role\":\"Designer\"},\"hidden\":true,\"colors\":\"[[224,0,29,0.5,90,200,100],[143,200,10,1,79,30,200]]\"},\r\n                ]\r\n            },\r\n            sketchList: {\r\n                \"sketch_list\":[\r\n                    {\r\n                        \"id\": 1,\r\n                        \"name\": \"balloon\",\r\n                        \"colors\": 6,\r\n                        \"data\": \"<svg t=\\\"1633693832542\\\" class=\\\"icon\\\" viewBox=\\\"0 0 1024 1024\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" p-id=\\\"1470\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" width=\\\"200\\\" height=\\\"200\\\">\\r\\n    <defs>\\r\\n        <style type=\\\"text/css\\\"></style>\\r\\n    </defs>\\r\\n    <path d=\\\"M413.5 629.7c-1.1-6.2-7.1-10.3-13.1-9.1-6.2 1.1-10.3 7-9.1 13.1l47.6 262.8c0.9 4.7 4.5 8.2 9 9.1 1.4 0.2 2.8 0.3 4.2 0 6.2-1.1 10.3-7 9.1-13.1l-47.7-262.8zM563.1 892.5c-1.1 6.2 3 12.1 9.1 13.1 1.4 0.2 2.8 0.2 4.2 0 4.5-0.9 8.1-4.4 9-9.1L633 633.8c1.1-6.2-3-12.1-9.1-13.1-6.2-1.1-12.1 3-13.1 9.1l-47.7 262.7z\\\" %%1%% p-id=\\\"1471\\\"></path>\\r\\n    <path d=\\\"M598.4 982H425.7c-23.3 0-42.3-18.9-42.3-42.3v-79.9c0-16.7 13.5-30.1 30.1-30.1h196.9c16.7 0 30.1 13.5 30.1 30.1v79.9c0.2 23.4-18.7 42.3-42.1 42.3z\\\" %%2%% p-id=\\\"1472\\\"></path>\\r\\n    <path d=\\\"M523.4 919.1v-27h40.5c6.3 0 11.3-5 11.3-11.3 0-5.1-3.3-9.4-8-10.8-1.1-0.3-2.2-0.5-3.3-0.5h-40.5v-39.7h-22.6v39.7H459v-39.7h-22.6v39.7h-52.6v22.6h52.6V982H459v-40.3h181.7v-22.6H523.4z m-22.7 0H459v-27h41.8l-0.1 27z\\\" %%3%% p-id=\\\"1473\\\"></path>\\r\\n    <path d=\\\"M797.3 417.9c-15.1 54-45.1 101.8-85.3 138.6-40.2 36.7-63.1 88.7-63.1 143 0 5.3-2.1 10.1-5.6 13.5-3.5 3.5-8.2 5.6-13.5 5.6H394.2c-5.2 0-10-2.1-13.6-5.6-3.4-3.4-5.7-8.2-5.7-13.6 0-54.4-22.8-106.2-62.8-142.8-40.3-36.9-70.4-84.7-85.5-138.8h187.6c-3.2-27.8-4.9-57.4-4.9-88.1 0-37.1 2.5-72.6 7.1-105.1H238.5C283.3 117.5 389.4 42 512.1 42h4.5c121.5 1.8 225.1 76.7 269.1 182.6h-178c4.6 32.6 7.1 68 7.1 105.1 0 30.7-1.7 60.3-4.9 88.1l187.4 0.1z\\\" %%4%% p-id=\\\"1474\\\"></path>\\r\\n    <path d=\\\"M614.7 329.8c0 30.7-1.7 60.3-4.9 88.1-6 52.5-17.3 98.4-32.1 133-16.2 38-25.1 78.7-25.1 120.1v47.7h-81.2V671c0-41.3-8.9-82.1-25.1-120.1-14.7-34.5-26-80.5-32-133-3.2-27.8-4.9-57.4-4.9-88.1 0-37.1 2.5-72.6 7.1-105.1C431.4 117.7 468.6 42 512.1 42c28.4 0 54 32.2 72.6 84.3 9.9 27.8 17.8 61.2 23 98.4 4.5 32.5 7 68 7 105.1z\\\" %%1%% p-id=\\\"1475\\\"></path>\\r\\n    <path d=\\\"M808.2 338.1c0 27.6-3.8 54.4-10.9 79.8H226.7c-7.2-25.9-11-53.2-10.9-81.4 0.2-39.6 8.3-77.4 22.7-111.8h547.1c14.6 34.9 22.6 73.2 22.6 113.4z\\\" %%5%% p-id=\\\"1476\\\"></path>\\r\\n    <path d=\\\"M614.7 329.8c0 30.7-1.7 60.3-4.9 88.1H414.3c-3.2-27.8-4.9-57.4-4.9-88.1 0-37.1 2.5-72.6 7.1-105.1h191.2c4.5 32.5 7 68 7 105.1z\\\" %%6%% p-id=\\\"1477\\\"></path>\\r\\n</svg>\",\r\n                        \"hidden\": null,\r\n                        \"defaultValue\": \"[[\\\"#2F9B77\\\", 1],[\\\"#F2B843\\\", 1],[\\\"#EA800C\\\", 1],[\\\"#3DC38A\\\", 1],[\\\"#F2B843\\\", 1],[\\\"#EA800C\\\", 1]]\"\r\n                    }\r\n                ]\r\n            },\r\n            exploreScheme: {\"id\":87,\"submission_time\":1633797634,\"sketch_id\":1,\"name\":\"RuntimeErrrorrr\",\"description\":\"CodeGOGOOGOGOGOGO\",\"likes\":14,\"approved\":true,\"author\":{\"student_id\":2020010951,\"name\":\"cc7w\",\"fullname\":\"网络出问题啦~\",\"email\":\"gha@mails.tsinghua.edu.cn\",\"role\":\"Designer\"},\"hidden\":true,\"colors\":\"[[224,0,29,0.5,90,200,100],[143,200,10,1,79,30,200]]\"},\r\n            misc: {\r\n                sortStrategy: 'submission_time',\r\n                approved: false,\r\n            },\r\n            page: 'Creator', // 'Creator' or 'Explore' \r\n        }\r\n    },\r\n    reducers: {\r\n        updateMainPageState: (state, action) => {state.state = {...state.state, ...action.payload};}\r\n    }\r\n});\r\n\r\nexport const {updateColorState, updateCurrColorIndex} = colorEditorSlice.actions\r\nexport const {updatePickerState} = colorPickerSlice.actions\r\nexport const {updateSketchId} = creatorSlice.actions\r\nexport const {updateMainPageState} = mainPageSlice.actions\r\nexport const getColorState = (state: any) => {return state.colorEditor.colorState};\r\nexport const getCurrColorIndex = (state: any) => {return state.colorEditor.currColorIndex};\r\nexport const getPickerState = (state: any) => { return state.colorPicker.colorState;};\r\nexport const getCreatorSketchId = (state: any) => { return state.creator.sketchId;};\r\nexport const getMainPageState = (state: any) => {return state.mainPage.state}\r\n\r\n\r\nexport default configureStore({\r\n  reducer: {\r\n    colorEditor: colorEditorSlice.reducer,\r\n    colorPicker: colorPickerSlice.reducer,\r\n    creator: creatorSlice.reducer,\r\n    mainPage: mainPageSlice.reducer,\r\n  },\r\n})","import { useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { getColorState, getCreatorSketchId, getCurrColorIndex, updateColorState, updatePickerState, updateSketchId } from \"../../store\";\r\nimport { RGB2HSV, String2ArrayRGB } from \"../../utils/Color\";\r\nimport ColorEditor from \"./ColorEditor/ColorEditor\";\r\nimport SketchList from \"./SketchList/SketchList\";\r\n\r\ninterface CreatorProps {\r\n    sketch: any; //原始的“{scheme:...}”字符串\r\n    onSubmit: (sketch_id: number, name: string, discription: string, color_List: number[][]) => void;\r\n}\r\n\r\n\r\nconst Creator = (props: CreatorProps) => {\r\n\r\n    const sketchId = useSelector(getCreatorSketchId);\r\n    const colorState = useSelector(getColorState);\r\n    const currColorIndex = useSelector(getCurrColorIndex);\r\n    const dispatch = useDispatch();\r\n    const [init, setInit] = useState(0);\r\n    \r\n    const getInitColorValue = (sketchId: number) => {\r\n        return eval(JSON.parse(props.sketch).sketch_list.filter((sketch: any)=>{return sketch.id === sketchId})[0].defaultValue).map((list: any) => {\r\n        // [\"#aabbcc\", 1] => [RGBAHSV]\r\n        const RGB_ = String2ArrayRGB(list[0]);\r\n        const RGBList = [0,0,0,list[1], RGB_[0], RGB_[1], RGB_[2]];\r\n        const fullList = RGB2HSV(RGBList);\r\n        return [\r\n            fullList[4],\r\n            fullList[5],\r\n            fullList[6],\r\n            fullList[3],\r\n            fullList[0],\r\n            fullList[1],\r\n            fullList[2]\r\n        ];\r\n    })};\r\n\r\n    useEffect(()=>{\r\n        // console.debug('sketch id changed')\r\n        setInit(init+1);\r\n    }, [sketchId]);\r\n\r\n    useEffect(()=>{\r\n        dispatch(updateColorState(getInitColorValue(sketchId)));\r\n        dispatch(updatePickerState(colorState[currColorIndex]));\r\n    }, [props.sketch]);\r\n\r\n    const getSketch = () => {return JSON.parse(props.sketch).sketch_list.filter((sketch: any)=>{return sketch.id === sketchId})[0].data;};\r\n\r\n    return (\r\n        <>\r\n            <div className=\"ColorEditor\">\r\n                <ColorEditor \r\n                    sketch={getSketch()} \r\n                    sketch_id={sketchId} \r\n                    initColorValue={getInitColorValue(sketchId)} \r\n                    onSubmit={props.onSubmit} />\r\n            </div>\r\n            <div className=\"SketchList\">\r\n                <SketchList str={props.sketch} onClickSketch={(id: number) => {\r\n                    dispatch(updateSketchId(id));\r\n                    dispatch(updateColorState(getInitColorValue(id)));\r\n                    // eslint-disable-next-line no-restricted-globals\r\n                    scrollTo(0,0);\r\n                    }}></SketchList>\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default Creator;","import React from 'react';\r\nimport { String2ArrayRGB } from '../../../utils/Color';\r\nimport '../../../styles/SketchList.css';\r\nimport Preview from '../ColorEditor/WorkSpace/Preview'\r\nimport { Tooltip } from 'antd';\r\n\r\ninterface choose_props {\r\n    readonly str: string; //原始的“{scheme:...}”字符串\r\n    // readonly colorValueList: Array<Array<Array<number>>>; // 颜色三维数组\r\n    readonly onClickSketch: (id: number) => void; //回调\r\n}\r\n\r\ninterface choose_state {\r\n    readonly pre_id: number;\r\n}\r\n\r\nclass ChooseSketch extends React.Component<choose_props, choose_state>{\r\n\r\n    constructor(props: choose_props) {\r\n        super(props);\r\n        this.state = ({pre_id: 0,});\r\n    }\r\n    //处理鼠标点击\r\n    handler(i: number){\r\n        // console.log(\"pre_id: \" + this.state.pre_id + \" i: \" + i);\r\n        // let e = document.getElementById(\"sketch\" + i);\r\n        // let pre_e = document.getElementById(\"sketch\" + this.state.pre_id);\r\n        // // @ts-ignore\r\n        // pre_e.style.boxShadow = \"0 0\";\r\n        // // @ts-ignore\r\n        // e.style.boxShadow = \"0 0 10px\";\r\n        this.props.onClickSketch(i);\r\n\r\n        // this.setState({\r\n        //     pre_id: i,\r\n        // });\r\n    }\r\n\r\n    render() {\r\n        let rawList = JSON.parse(this.props.str).sketch_list; // 解析列表，用于获取 svg 代码\r\n        let list = rawList.map((sketch: any) => {\r\n            return eval(sketch.defaultValue).map((list: any) => {\r\n                // [\"#2F9B77\", 1] => [RGBAHSV]\r\n                const newColorArray = [255,255,255,list[1],0,0,0];\r\n                // TODO: Color/Convert RGB String to RGB List\r\n                const RGBList = String2ArrayRGB(list[0]); // TODO\r\n                newColorArray[0] = RGBList[0];\r\n                newColorArray[1] = RGBList[1];\r\n                newColorArray[2] = RGBList[2];\r\n                \r\n                return newColorArray;\r\n            })\r\n        })\r\n        let scratch_num = list.length;\r\n        let row = Math.trunc(scratch_num / 4) + 1;\r\n        let all_items = [];\r\n        for (let i = 0; i < row; i++){\r\n            let inside_arr = [];\r\n            for (let j = 0; j <= Math.min(3, scratch_num - i * 4 - 1); j++){\r\n                let index = i * 4 + j;\r\n                let scratch_data = rawList[index].data;\r\n                inside_arr.push(\r\n                    <Tooltip placement=\"right\" title=\"请点击我以进行着色哦\" color=\"#2db7f5\" arrowPointAtCenter>\r\n                        <div style={{margin: '10px', cursor: 'pointer', backgroundColor: 'rgba(230,230,230,0.8)', borderRadius: '1rem', padding: '1rem'}} onClick={() => {this.handler(rawList[index].id)}}>\r\n                            <Preview raw_str={scratch_data} color_arr={list[index]} />\r\n                        </div>\r\n                    </Tooltip>\r\n                );\r\n            }\r\n            all_items.push(<div className={\"one_row\"} key={\"row\"+i}>{inside_arr}</div>);\r\n        }\r\n\r\n        return (\r\n           <div className={\"all_items\"}>{all_items}</div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default ChooseSketch;\r\n\r\n\r\n","import { Input, message, Tooltip } from \"antd\";\r\nimport TextArea from \"antd/lib/input/TextArea\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { getMainPageState, updateColorState, updateCurrColorIndex, updateMainPageState, updatePickerState, updateSketchId } from \"../../store\";\r\nimport Preview from \"../Creator/ColorEditor/WorkSpace/Preview\";\r\nimport '../../styles/Explorer.css'\r\nimport {HeartOutlined, CheckCircleOutlined, DownloadOutlined, EditOutlined, DoubleRightOutlined} from '@ant-design/icons'\r\nimport { changeUserScheme, getExploreScheme } from \"../../utils/Network\";\r\n\r\n\r\n\r\nconst Explorer = ()=>{\r\n\r\n    const mainPageState = useSelector(getMainPageState);\r\n    const dispatch = useDispatch();\r\n\r\n    const getExploreRawSvg = (): string => {\r\n        const sketch_id = mainPageState.exploreScheme.sketch_id;\r\n        const filtered = mainPageState.sketchList.sketch_list.filter((sketch: any) => {return sketch.id === sketch_id});\r\n        if (filtered.length === 0) return '';\r\n        return filtered[0].data;\r\n    };\r\n\r\n\r\n    //刷新随机浏览界面\r\n    const refreshExplore = () : void => {\r\n        getExploreScheme(0, 'submission_time', false).then(\r\n            resp=>{\r\n                // TODO: 校验正确性\r\n                // TODO: 使用获得的 scheme 更新全局变量的 exploreScheme 的值\r\n                const schemeList = resp.schemes;\r\n                // Generate a random number between [0, schemeList.length)\r\n                const randomIndex = Math.floor(Math.random() * schemeList.length);\r\n                const newScheme = schemeList[randomIndex];\r\n\r\n                dispatch(updateMainPageState({exploreScheme: newScheme}));\r\n\r\n            }\r\n        )\r\n    }\r\n\r\n    //切换界面\r\n    const switchPage = (refresh: boolean) => {\r\n        if(refresh) {refreshExplore();}\r\n        dispatch(updateMainPageState({page: mainPageState.page === 'Creator' ? 'Explore' : 'Creator'}));\r\n    };\r\n\r\n    const vote = (): void => {\r\n        changeUserScheme(\"vote\",mainPageState.exploreScheme.id,[],'','',mainPageState.userInfo.student_id,0).then(\r\n            (resp: any)=>{\r\n                if (resp.err) {\r\n                    message.error(\"点赞失败...\");\r\n                } else {\r\n                    message.success(\"点赞成功~\");\r\n                }\r\n            }\r\n        )\r\n    }\r\n\r\n    const unvote = (): void => {\r\n        changeUserScheme(\"unvote\",mainPageState.exploreScheme.id,[],'','',mainPageState.userInfo.student_id,0).then(\r\n            (resp: any)=>{\r\n                if (resp.err) {\r\n                    message.error(\"取消点赞失败...\");\r\n                } else {\r\n                    message.success(\"取消点赞成功~\");\r\n                }\r\n            }\r\n        )\r\n    }\r\n\r\n    const approve = () => {\r\n        if (mainPageState.userInfo.role === 'Designer') {\r\n            if(mainPageState.exploreScheme.approved) {\r\n                changeUserScheme(\"disapprove\",mainPageState.exploreScheme.id,[],\"\",\"\",\"\",0).then(()=>{message.success(\"取消遴选成功~\")});\r\n                const newExploreScheme = JSON.parse(JSON.stringify(mainPageState.exploreScheme));\r\n                newExploreScheme.approved = false;\r\n                dispatch(updateMainPageState({exploreScheme: newExploreScheme}));\r\n            } else {\r\n                changeUserScheme(\"approve\",mainPageState.exploreScheme.id,[],\"\",\"\",\"\",0).then(()=>{message.success(\"遴选成功~\")});\r\n                const newExploreScheme = JSON.parse(JSON.stringify(mainPageState.exploreScheme));\r\n                newExploreScheme.approved = true;\r\n                dispatch(updateMainPageState({exploreScheme: newExploreScheme}));\r\n            }\r\n            \r\n        }\r\n    };\r\n\r\n    function like():void{\r\n        if(mainPageState.exploreScheme.liked){\r\n            const newExploreScheme = JSON.parse(JSON.stringify(mainPageState.exploreScheme));\r\n            newExploreScheme.liked = false;\r\n            newExploreScheme.likes -= 1;\r\n            dispatch(updateMainPageState({exploreScheme: newExploreScheme}));\r\n            unvote();\r\n        } else {\r\n            const newExploreScheme = JSON.parse(JSON.stringify(mainPageState.exploreScheme));\r\n            newExploreScheme.liked = true;\r\n            newExploreScheme.likes += 1;\r\n            dispatch(updateMainPageState({exploreScheme: newExploreScheme}));\r\n            vote();\r\n        }\r\n\r\n    }\r\n\r\n    //下一张\r\n    const next = (): void => {refreshExplore();}\r\n\r\n    //编辑\r\n    const edit = ():void => {\r\n        switchPage(false);\r\n        const exploreScheme = mainPageState.exploreScheme;\r\n\r\n        const sketch_id = exploreScheme.sketch_id;\r\n        const color = eval(exploreScheme.colors);\r\n        console.debug(color);\r\n\r\n        // set states\r\n        dispatch(updateCurrColorIndex(0));\r\n        dispatch(updatePickerState(color[0]));\r\n        dispatch(updateSketchId(sketch_id));\r\n        dispatch(updateColorState(color));\r\n\r\n        // eslint-disable-next-line no-restricted-globals\r\n        scrollTo(0,0);\r\n    }\r\n\r\n    const download = ()=>{\r\n        // TODO\r\n        function fakeClick(obj: any) {\r\n            let ev = document.createEvent(\"MouseEvents\");\r\n            ev.initMouseEvent(\"click\", true, false, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);\r\n            obj.dispatchEvent(ev);\r\n        }\r\n\r\n        function exportRaw(name: any, data: any) {\r\n            let urlObject = window.URL || window.webkitURL || window;\r\n            let export_blob = new Blob([data]);\r\n            let save_link : any = document.createElementNS(\"http://www.w3.org/1999/xhtml\", \"a\")\r\n            save_link.href = urlObject.createObjectURL(export_blob);\r\n            save_link.download = name;\r\n            fakeClick(save_link);\r\n        }\r\n\r\n        let my_color =  mainPageState.exploreScheme.colors; // [RGBAHSV]\r\n        let color_num;\r\n        let color_saved = []\r\n\r\n        color_num = my_color.length;\r\n        for (let i = 0; i < color_num; i++){\r\n            let tmp = my_color[i][0].toString(16).padStart(2, '0');\r\n            tmp += my_color[i][1].toString(16).padStart(2, '0');\r\n            tmp += my_color[i][2].toString(16).padStart(2, '0');\r\n            tmp = \"fill=\" + '\"#' + tmp + '\"';\r\n            \r\n            color_saved.push(tmp);\r\n        }\r\n\r\n        let svg = getExploreRawSvg();\r\n        for (let i = 1; i <= color_num; i++) {\r\n            let tmp = \"%%\" + i.toString() + \"%%\";\r\n            svg = svg.replaceAll(tmp, color_saved[i-1]);\r\n        }\r\n\r\n        exportRaw(mainPageState.exploreScheme.name + '.svg', svg)\r\n    };\r\n\r\n    return (<div className={\"Explorer\"} >\r\n        <div className=\"ExplorerViewer\">\r\n            <Preview raw_str={getExploreRawSvg()} color_arr={mainPageState.exploreScheme.colors}/>\r\n        </div>\r\n        <div className=\"ExplorerIntro\">\r\n            <Input\r\n                disabled\r\n                value={mainPageState.exploreScheme.name}\r\n                addonBefore=\"配色方案名称\"\r\n                style={{textAlign: 'center', color: 'black'}}\r\n            />\r\n                \r\n            <TextArea\r\n                autoSize={{ minRows: 3, maxRows: 3 }}\r\n                disabled\r\n                value={mainPageState.exploreScheme.description}\r\n            />\r\n        </div>\r\n        <div className=\"ExplorerOperations\" style={{userSelect: 'none'}}>\r\n            <div className=\"ExplorerSelect\">\r\n                <Tooltip title=\"遴选\"><CheckCircleOutlined \r\n                    style={{\r\n                        fontSize: '1.5rem',\r\n                        color: mainPageState.exploreScheme.approved ? 'green' : 'grey',\r\n                        \r\n                    }} \r\n                    onClick={()=>{approve()}}\r\n                /></Tooltip>\r\n            </div>\r\n            <div className=\"ExplorerLike\" style={{display: 'flex', justifyContent:'center', alignItems:'center'}}>\r\n                <Tooltip title=\"点赞\"><HeartOutlined  \r\n                    style={{\r\n                        fontSize: '1.5rem',\r\n                        color: mainPageState.exploreScheme.liked ? 'red' : undefined\r\n                        \r\n                    }} \r\n                    onClick={()=>{like()}}\r\n                /></Tooltip>\r\n                <span style={{marginLeft: '0.5rem', fontSize: '0.9rem'}}>{mainPageState.exploreScheme.likes}</span>\r\n            </div>\r\n            <div className=\"ExplorerDownload\">\r\n                <Tooltip title=\"下载\"><DownloadOutlined  \r\n                    style={{\r\n                        fontSize: '1.5rem',\r\n                        color: 'black'\r\n                        \r\n                    }} \r\n                    onClick={()=>{download()}}\r\n                /></Tooltip>\r\n            </div>\r\n            <div className=\"ExplorerEdit\">\r\n                <Tooltip title=\"编辑\"><EditOutlined  \r\n                    style={{\r\n                        fontSize: '1.5rem',\r\n                        color: 'black'\r\n                        \r\n                    }} \r\n                    onClick={()=>{edit()}}\r\n                /></Tooltip>\r\n            </div>\r\n            <div className=\"ExplorerNext\">\r\n                <Tooltip title=\"下一张\"><DoubleRightOutlined \r\n                    style={{\r\n                        fontSize: '1.5rem',\r\n                        color: 'black'\r\n                        \r\n                    }} \r\n                    onClick={()=>{next()}}\r\n                /></Tooltip>\r\n            </div>\r\n\r\n        </div>\r\n    </div>);\r\n};\r\n\r\nexport default Explorer;","import React from 'react';\r\nimport '../../styles/HistoryList.css';\r\nimport { Button } from 'antd';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport {faCheckCircle, faTimesCircle, faTrash} from \"@fortawesome/free-solid-svg-icons\";\r\nimport { useSelector } from 'react-redux';\r\nimport { getCreatorSketchId } from '../../store';\r\n\r\ninterface history_props {\r\n    readonly sort: (type:string, approved: boolean)=>void;\r\n    readonly getString: string;\r\n    readonly show_select: boolean;\r\n    readonly approve: (type:number)=>void;\r\n    readonly delete: (type:number)=>void;\r\n    readonly explore: (type:number)=>void;\r\n    readonly disapprove: (type:number)=>void;\r\n}\r\n\r\ninterface piece_props {\r\n    readonly ifhide: boolean;\r\n    readonly ifapprove: boolean;\r\n    readonly id: number;\r\n    readonly pic_class: number;\r\n    readonly select: boolean;\r\n    readonly color_num: number;\r\n    readonly color_str: any;\r\n    readonly author: string;\r\n    readonly pic_name: string;\r\n\r\n    readonly approve: (type:number)=>void;\r\n    readonly delete: (type:number)=>void;\r\n    readonly explore: (type:number)=>void;\r\n    readonly disapprove: (type:number)=>void;\r\n}\r\n\r\ninterface piece_state {\r\n    readonly ifapproved: boolean;\r\n}\r\n\r\nclass Piece extends React.Component<piece_props, piece_state> {\r\n\r\n    constructor(props: piece_props) {\r\n        super(props);\r\n        this.state={ifapproved:props.ifapprove};\r\n    }\r\n\r\n    handler (ifapprove: boolean, id: number) {\r\n        if (ifapprove){\r\n            this.props.disapprove(id);\r\n            this.setState({ifapproved:false});\r\n        }\r\n        else {\r\n            this.props.approve(id);\r\n            this.setState({ifapproved:true});\r\n        }\r\n    }\r\n\r\n    render () {\r\n        let color_bind = [];\r\n        for (let i = 0; i < this.props.color_num; i++) {\r\n            let tmp_str = \"rgba(\" + this.props.color_str[i][0] + \",\" + this.props.color_str[i][1] + \",\" + this.props.color_str[i][2] + \",\" + this.props.color_str[i][3] + \")\";\r\n            color_bind.push(<div className=\"color\" style={{backgroundColor: tmp_str, opacity: this.props.color_str[i][3]}}/>);\r\n        }\r\n        if (this.props.select) {\r\n            if(this.props.ifapprove) {\r\n                if (this.props.ifhide) {\r\n                    return (\r\n                        <div className={\"piece\"}>\r\n                            {/* <div className={\"pic_class\"}>{this.props.pic_class}</div>\r\n                            <div className={\"delete\"} onClick={()=>{this.props.delete(this.props.id)}}>\r\n                                <FontAwesomeIcon icon={faTrash} style={{color:\"red\"}}/>\r\n                            </div> */}\r\n                            <div className={\"select\"} onClick={()=>{this.handler(this.state.ifapproved, this.props.id)}}>\r\n                                <FontAwesomeIcon icon={faCheckCircle} style={{color:\"green\"}}/>\r\n                            </div>\r\n                            <div className=\"color_bind\" onClick={()=>{this.props.explore(this.props.id)}}>\r\n                                {color_bind}\r\n                            </div>\r\n                            <div className=\"author\">{this.props.author}</div>\r\n                            <div className=\"pic_name\">{this.props.pic_name}</div>\r\n                        </div>\r\n                    )\r\n                }\r\n                else {\r\n                    return (\r\n                        <div className={\"piece\"}>\r\n                            {/* <div className={\"pic_class\"}>{this.props.pic_class}</div>\r\n                            <div className={\"delete\"} onClick={()=>{this.props.delete(this.props.id)}}>\r\n                                <FontAwesomeIcon icon={faTrash}/>\r\n                            </div>*/}\r\n                            <div className={\"select\"} onClick={()=>{this.handler(this.state.ifapproved, this.props.id)}}>\r\n                                <FontAwesomeIcon icon={faCheckCircle} style={{color:\"green\"}}/>\r\n                            </div> \r\n                            <div className=\"color_bind\" onClick={()=>{this.props.explore(this.props.id)}}>\r\n                                {color_bind}\r\n                            </div>\r\n                            <div className=\"author\">{this.props.author}</div>\r\n                            <div className=\"pic_name\">{this.props.pic_name}</div>\r\n                        </div>\r\n                    )\r\n                }\r\n            }\r\n            else {\r\n                if (this.props.ifhide) {\r\n                    return (\r\n                        <div className={\"piece\"}>\r\n                            {/* <div className={\"pic_class\"}>{this.props.pic_class}</div>\r\n                            <div className={\"delete\"} onClick={()=>{this.props.delete(this.props.id)}}>\r\n                                <FontAwesomeIcon icon={faTrash} style={{color:\"red\"}}/>\r\n                            </div>*/}\r\n                            <div className={\"select\"} onClick={()=>{this.handler(this.state.ifapproved, this.props.id)}}>\r\n                                <FontAwesomeIcon icon={faCheckCircle} style={{color:\"grey\"}}/>\r\n                            </div> \r\n                            <div className=\"color_bind\" onClick={()=>{this.props.explore(this.props.id)}}>\r\n                                {color_bind}\r\n                            </div>\r\n                            <div className=\"author\">{this.props.author}</div>\r\n                            <div className=\"pic_name\">{this.props.pic_name}</div>\r\n                        </div>\r\n                    )\r\n                }\r\n                else {\r\n                    return (\r\n                        <div className={\"piece\"}>\r\n                            {/* <div className={\"pic_class\"}>{this.props.pic_class}</div>\r\n                            <div className={\"delete\"} onClick={()=>{this.props.delete(this.props.id)}}>\r\n                                <FontAwesomeIcon icon={faTrash}/>\r\n                            </div>*/}\r\n                            <div className={\"select\"} onClick={()=>{this.handler(this.state.ifapproved, this.props.id)}}>\r\n                                <FontAwesomeIcon icon={faCheckCircle} style={{color:\"grey\"}}/>\r\n                            </div> \r\n                            <div className=\"color_bind\" onClick={()=>{this.props.explore(this.props.id)}}>\r\n                                {color_bind}\r\n                            </div>\r\n                            <div className=\"author\">{this.props.author}</div>\r\n                            <div className=\"pic_name\">{this.props.pic_name}</div>\r\n                        </div>\r\n                    )\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            if (this.props.ifhide) {\r\n                return (\r\n                    <div className={\"piece\"}>\r\n                        {/* <div className={\"pic_class\"}>{this.props.pic_class}</div>\r\n                        <div className={\"delete\"} onClick={()=>{this.props.delete(this.props.id)}}>\r\n                            <FontAwesomeIcon icon={faTrash} style={{color:\"red\"}}/>\r\n                        </div>*/}\r\n                        <div className={\"select\"} onClick={()=>{this.props.approve(this.props.id)}}></div> \r\n                        <div className=\"color_bind\" onClick={()=>{this.props.explore(this.props.id)}}>\r\n                            {color_bind}\r\n                        </div>\r\n                        <div className=\"author\">{this.props.author}</div>\r\n                        <div className=\"pic_name\">{this.props.pic_name}</div>\r\n                    </div>\r\n                )\r\n            }\r\n            else {\r\n                return (\r\n                    <div className={\"piece\"}>\r\n                        {/* <div className={\"pic_class\"}>{this.props.pic_class}</div>\r\n                        <div className={\"delete\"} onClick={()=>{this.props.delete(this.props.id)}}>\r\n                            <FontAwesomeIcon icon={faTrash}/>\r\n                        </div>*/}\r\n                        <div className={\"select\"} onClick={()=>{this.props.approve(this.props.id)}}></div> \r\n                        <div className=\"color_bind\" onClick={()=>{this.props.explore(this.props.id)}}>\r\n                            {color_bind}\r\n                        </div>\r\n                        <div className=\"author\">{this.props.author}</div>\r\n                        <div className=\"pic_name\">{this.props.pic_name}</div>\r\n                    </div>\r\n                )\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nconst HistoryList = (props: history_props)=>{\r\n\r\n    let currSketchId = useSelector(getCreatorSketchId);\r\n\r\n    let arr_left = [];\r\n        let arr_right = [];\r\n        let s = props.getString;\r\n        // let s = '{\"schemes\":[' +\r\n        //     '{\"id\":87,\"submission_time\":1633797634,\"sketch_id\":1,\"name\":\"RuntimeErrrorrr\",\"description\":\"CodeGOGOOGOGOGOGO\",\"likes\":14,\"approved\":true,\"author\":{\"student_id\":2020010951,\"name\":\"cc7w\",\"fullname\":\"昂\",\"email\":\"gha@mails.tsinghua.edu.cn\",\"role\":\"Designer\"},\"hidden\":false,\"colors\":\"[[224,0,29,0.5,90,200,100],[143,200,10,1,79,30,200]]\"}' +\r\n        //     ',{\"id\":87,\"submission_time\":1633797634,\"sketch_id\":1,\"name\":\"RuntimeErrrorrr\",\"description\":\"CodeGOGOOGOGOGOGO\",\"likes\":14,\"approved\":false,\"author\":{\"student_id\":2020010951,\"name\":\"cc7w\",\"fullname\":\"昂\",\"email\":\"gha@mails.tsinghua.edu.cn\",\"role\":\"Designer\"},\"hidden\":true,\"colors\":\"[[224,0,29,0.5,90,200,100],[143,200,10,1,79,30,200]]\"}' +\r\n        //     ',{\"id\":87,\"submission_time\":1633797634,\"sketch_id\":1,\"name\":\"RuntimeErrrorrr\",\"description\":\"CodeGOGOOGOGOGOGO\",\"likes\":14,\"approved\":false,\"author\":{\"student_id\":2020010951,\"name\":\"cc7w\",\"fullname\":\"昂\",\"email\":\"gha@mails.tsinghua.edu.cn\",\"role\":\"Designer\"},\"hidden\":false,\"colors\":\"[[224,0,29,0.5,90,200,100],[143,200,10,1,79,30,200]]\"}' +\r\n        //     ',{\"id\":87,\"submission_time\":1633797634,\"sketch_id\":1,\"name\":\"RuntimeErrrorrr\",\"description\":\"CodeGOGOOGOGOGOGO\",\"likes\":14,\"approved\":false,\"author\":{\"student_id\":2020010951,\"name\":\"cc7w\",\"fullname\":\"昂\",\"email\":\"gha@mails.tsinghua.edu.cn\",\"role\":\"Designer\"},\"hidden\":true,\"colors\":\"[[224,0,29,0.5,90,200,100],[143,200,10,1,79,30,200]]\"}' +\r\n        //     ',{\"id\":87,\"submission_time\":1633797634,\"sketch_id\":1,\"name\":\"RuntimeErrrorrr\",\"description\":\"CodeGOGOOGOGOGOGO\",\"likes\":14,\"approved\":true,\"author\":{\"student_id\":2020010951,\"name\":\"cc7w\",\"fullname\":\"昂\",\"email\":\"gha@mails.tsinghua.edu.cn\",\"role\":\"Designer\"},\"hidden\":true,\"colors\":\"[[224,0,29,0.5,90,200,100],[143,200,10,1,79,30,200]]\"}]}'\r\n        if (s !== \"\") {\r\n            let parjson = JSON.parse(s);\r\n            parjson.schemes = parjson.schemes.filter((scheme: any)=>{return scheme.sketch_id === currSketchId;})\r\n            let num = parjson.schemes.length;\r\n            let left_num = num - Math.trunc(num / 2);\r\n\r\n            for(let i = 0; i < left_num; i++){\r\n                let p = parjson.schemes[i];\r\n                let id = p.id;\r\n                let pic_class = p.sketch_id;\r\n                let select = props.show_select;\r\n                let mycolor = eval(p.colors);\r\n                let color_num = mycolor.length;\r\n                let author = p.author.fullname;\r\n                let pic_name = p.name;\r\n                let color_str = [];\r\n                let ifapprove = p.approved;\r\n                let ifhide = p.hidden;\r\n                for(let j = 0; j < color_num; j++){\r\n                    let r = mycolor[j][0]; //取rgb值的第一个,位置待定\r\n                    let g = mycolor[j][1];\r\n                    let b = mycolor[j][2];\r\n                    let a = mycolor[j][3];\r\n                    let tmp = [r, g, b, a];\r\n                    color_str.push(tmp);\r\n                }\r\n                arr_left.push(<Piece ifhide={ifhide} ifapprove={ifapprove} id={id} select={select} author={author} pic_name={pic_name} pic_class={pic_class} color_num={color_num}\r\n                                     color_str={color_str} explore={props.explore} delete={props.delete} approve={props.approve} disapprove={props.disapprove}/>)\r\n            }\r\n\r\n            for(let i = left_num; i < num; i++){\r\n                let p = parjson.schemes[i];\r\n                let id = p.id;\r\n                let pic_class = p.sketch_id;\r\n                let select = props.show_select;\r\n                let mycolor = eval(p.colors);\r\n                let color_num = mycolor.length;\r\n                let author = p.author.fullname;\r\n                let pic_name = p.name;\r\n                let color_str = [];\r\n                let ifapprove = p.approved;\r\n                let ifhide = p.hidden;\r\n                for(let j = 0; j < color_num; j++){\r\n                    let r = mycolor[j][0]; //取rgb值的第一个,位置待定\r\n                    let g = mycolor[j][1];\r\n                    let b = mycolor[j][2];\r\n                    let a = mycolor[j][3];\r\n                    let tmp = [r, g, b, a];\r\n                    color_str.push(tmp);\r\n                }\r\n                arr_right.push(<Piece ifhide={ifhide} ifapprove={ifapprove} id={id} select={select} author={author} pic_name={pic_name} pic_class={pic_class} color_num={color_num}\r\n                                     color_str={color_str} explore={props.explore} delete={props.delete} approve={props.approve} disapprove={props.disapprove}/>)\r\n            }\r\n        \r\n            return(\r\n            <div className={\"history_list\"}>\r\n                <div className={\"order_buttons\"}>\r\n                    <Button shape={\"round\"} className={\"order_button\"} onClick={() => props.sort(\"vote\", false)}>点赞降序</Button>\r\n                    <Button shape={\"round\"} className={\"order_button\"} onClick={() => props.sort(\"hue\", false)}>色相顺序</Button>\r\n                    <Button shape={\"round\"} className={\"order_button\"} onClick={() => props.sort(\"designer_name\", false)}>作者顺序</Button>\r\n                    <div style={{flexGrow: 1}}></div>\r\n                    <Button shape={\"round\"} className={\"order_button\"} onClick={()=>{props.sort(\"\", true)}}>仅查看遴选</Button>\r\n                </div>\r\n                <div className={\"two_lists\"}>\r\n                    <div className={\"left_list\"}>\r\n                        <div className={\"piece\"}>\r\n                            {/* <div className={\"pic_class\"}>图号</div>\r\n                            <div className={\"delete\"}></div>*/}\r\n                            <div className={\"select\"}></div> \r\n                            <div className=\"color_bind\">配色方案</div>\r\n                            <div className=\"author\">作者</div>\r\n                            <div className=\"pic_name\">方案名称</div>\r\n                        </div>\r\n                        <div>\r\n                            {arr_left}\r\n                        </div>\r\n                    </div>\r\n                    <div className={\"left_list\"}>\r\n                        <div className={\"piece\"}>\r\n                            {/* <div className={\"pic_class\"}>图号</div>\r\n                            <div className={\"delete\"}></div> */}\r\n                            <div className={\"select\"}></div>\r\n                            <div className=\"color_bind\">配色方案</div>\r\n                            <div className=\"author\">作者</div>\r\n                            <div className=\"pic_name\">方案名称</div>\r\n                        </div>\r\n                        <div>\r\n                            {arr_right}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            )\r\n        } else {\r\n            return <></>\r\n        }\r\n            \r\n\r\n};\r\n\r\nexport default HistoryList;\r\n","import React from \"react\";\r\nimport { Tooltip } from \"antd\";\r\n\r\ninterface ColorButtonProps {\r\n    id: number;\r\n    onClick: (id: number) => void; // 回调函数，声明自己被选中\r\n    color: Array<number>;\r\n    selected: boolean;\r\n}\r\n\r\nexport default function ColorButton (props: ColorButtonProps){\r\n\r\n    const handleClick = () => {\r\n        props.onClick(props.id);\r\n    };\r\n\r\n    if(! props.color) return <></>;\r\n    \r\n    return (\r\n        <div className=\"wrapper\" id={\"wrapper\" + props.id.toString()}>\r\n            <Tooltip placement=\"topLeft\" title=\"请选中以编辑此色块\" color=\"#2db7f5\" arrowPointAtCenter>\r\n                <button className=\"colorButton\"\r\n                        id={\"button\" + props.id.toString()}\r\n                        onClick={handleClick}\r\n                        style={{\r\n                            backgroundColor: \"rgb(\" + props.color[0] +',' + props.color[1] + ',' + props.color[2] +  \")\",\r\n                            boxShadow: (()=>{ if (props.selected) {\r\n                                return \"0 0 20px rgb(\" + props.color[0] +',' + props.color[1] + ',' + props.color[2] +  \")\"\r\n                            } else {return \"\"}})()\r\n                        }}\r\n                />\r\n            </Tooltip>\r\n        </div>\r\n\r\n    )\r\n}","import {Col, InputNumber, Row, Tooltip} from \"antd\";\r\nimport Slider from \"rc-slider\";\r\nimport React from \"react\";\r\n\r\ninterface ColorSliderProps {\r\n    readonly description: string; // 文字描述\r\n    readonly onChange: (id: number, value: number) => void ; // 回调函数\r\n    readonly step: number; // 滑动间距\r\n    readonly id: number; // 第几个滑动条\r\n    readonly min: number; // 滑动条最小值\r\n    readonly max: number; // 滑动条最大值\r\n    readonly value: number; // 设置滑动条值\r\n}\r\n\r\nexport default function ColorSlider(props: ColorSliderProps) {\r\n    // 监听滑块滑动并设置当前状态\r\n    const onChange = (value: number) => {\r\n        if(!value){\r\n            value = 0;\r\n        }\r\n        props.onChange(props.id, value);\r\n    }\r\n\r\n    let colorGradient: string = \"\";\r\n    let propsString: string = \"\";\r\n    let opacity: number = 0;\r\n    switch (props.id){\r\n        case 0:\r\n            colorGradient = \"linear-gradient(to right, #f00 0%, #ff0 16.66%, #0f0 33.33%, #0ff 50%, #00f 66.66%, #f0f 83.33%, #f00 100%)\";\r\n            propsString = \"请输入 0-360 的整数\";\r\n            break;\r\n        case 1:\r\n            colorGradient = \"linear-gradient(to right, white, transparent)\";\r\n            propsString = \"请输入 0-1 的小数\";\r\n            break;\r\n        case 2:\r\n            colorGradient = \"linear-gradient(to right, black, transparent)\";\r\n            propsString = \"请输入 0-1 的小数\";\r\n            break;\r\n        case 3:\r\n            opacity = 1;\r\n            propsString = \"请输入 0-1 的小数\";\r\n            break;\r\n        case 4:\r\n            colorGradient = \"linear-gradient(to right, transparent, red)\";\r\n            propsString = \"请输入 0-255 的整数\";\r\n            break;\r\n        case 5:\r\n            colorGradient = \"linear-gradient(to right, transparent, green)\";\r\n            propsString = \"请输入 0-255 的整数\";\r\n            break;\r\n        case 6:\r\n            colorGradient = \"linear-gradient(to right, transparent, blue)\";\r\n            propsString = \"请输入 0-255 的整数\";\r\n            break;\r\n    }\r\n    return (\r\n        <div className=\"colorBlock\">\r\n            <div className=\"colorDescription\">\r\n                <p><b>{props.description}</b></p>\r\n            </div>\r\n            <div className=\"colorSlider\">\r\n                <Row>\r\n                    <Col span={12}>\r\n                        <Tooltip placement=\"topLeft\" title=\"请拖动我以进行编辑哦\" color=\"#2db7f5\" arrowPointAtCenter>\r\n                            <Slider\r\n                                min={props.min}\r\n                                max={props.max}\r\n                                onChange={onChange}\r\n                                step={props.step}\r\n                                trackStyle={{\r\n                                    opacity: opacity\r\n                                }}\r\n                                railStyle={{\r\n                                    backgroundImage: colorGradient\r\n                                }}\r\n                                value={props.value}\r\n                            />\r\n                        </Tooltip>\r\n\r\n                    </Col>\r\n                    <Col span={4}>\r\n                        <Tooltip placement=\"topLeft\" title={propsString} color=\"#2db7f5\" arrowPointAtCenter>\r\n                            <InputNumber\r\n                                min={props.min}\r\n                                max={props.max}\r\n                                style={{ margin: '0 16px' }}\r\n                                value={props.value}\r\n                                onChange={onChange}\r\n                            />\r\n                        </Tooltip>\r\n                    </Col>\r\n                </Row>\r\n            </div>\r\n        </div>\r\n    )\r\n}","import React, { useEffect, useState } from \"react\";\r\nimport \"../../../../styles/ColorEditor.css\";\r\n\r\nimport ColorSlider from \"./ColorSlider\";\r\nimport { HSV2RGB, RGB2HSV } from \"../../../../utils/Color\";\r\n\r\nimport \"rc-slider/assets/index.css\";\r\n\r\nimport { Button, Input } from \"antd\";\r\nimport TextArea from \"antd/lib/input/TextArea\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { getPickerState, updatePickerState } from \"../../../../store\";\r\n\r\n\r\ninterface ColorPickerProps {\r\n    initColor: Array<number>;\r\n    onSubmit: (name:string,description:string)=>void;\r\n    colorOnChange: (newColorArray: Array<number>)=>void;\r\n};\r\n\r\nconst ColorPicker = (props: ColorPickerProps) => {\r\n\r\n    const colorPickerState = useSelector(getPickerState);\r\n    const dispatch = useDispatch();\r\n    const [name, setName] = useState(\"\");\r\n    const [description, setDescription] = useState(\"\");\r\n\r\n    const colorOnChange = (id: number, value: number) => {\r\n        const colorArrayBefore = [\r\n          colorPickerState[4],\r\n          colorPickerState[5],\r\n          colorPickerState[6],\r\n          colorPickerState[3],\r\n          colorPickerState[0],\r\n          colorPickerState[1],\r\n          colorPickerState[2],\r\n        ];\r\n        colorArrayBefore[id] = value;\r\n        let colorArrayAfter = colorArrayBefore;\r\n        if (id < 3){\r\n            colorArrayAfter = HSV2RGB(colorArrayBefore);\r\n        }\r\n        else if (id > 3){\r\n            colorArrayAfter = RGB2HSV(colorArrayBefore);\r\n        }\r\n        const newColorArray = [\r\n          colorArrayAfter[4],\r\n          colorArrayAfter[5],\r\n          colorArrayAfter[6],\r\n          colorArrayAfter[3],\r\n          colorArrayAfter[0],\r\n          colorArrayAfter[1],\r\n          colorArrayAfter[2],\r\n        ];\r\n\r\n        dispatch(updatePickerState(newColorArray))\r\n        props.colorOnChange(newColorArray);\r\n    };\r\n\r\n    useEffect(()=>{\r\n      dispatch(updatePickerState(props.initColor));\r\n    }, []);\r\n\r\n\r\n  return (\r\n    <div className=\"colorPicker\">\r\n      <div className=\"HSVColor\">\r\n        <ColorSlider\r\n          description=\"色相(H):\"\r\n          id={0}\r\n          onChange={colorOnChange}\r\n          value={colorPickerState[4]}\r\n          step={1}\r\n          min={0}\r\n          max={360}\r\n        />\r\n        <ColorSlider\r\n          description=\"饱和度(S):\"\r\n          id={1}\r\n          onChange={colorOnChange}\r\n          value={colorPickerState[5]}\r\n          step={0.01}\r\n          min={0}\r\n          max={1}\r\n        />\r\n        <ColorSlider\r\n          description=\"明度(V):\"\r\n          id={2}\r\n          onChange={colorOnChange}\r\n          value={colorPickerState[6]}\r\n          step={0.01}\r\n          min={0}\r\n          max={1}\r\n        />\r\n        <ColorSlider\r\n          description=\"透明度(A)\"\r\n          id={3}\r\n          onChange={colorOnChange}\r\n          value={colorPickerState[3]}\r\n          step={0.01}\r\n          min={0}\r\n          max={1}\r\n        />\r\n      </div>\r\n      <div className=\"RGBColor\">\r\n        <ColorSlider\r\n          description=\"红色(R):\"\r\n          id={4}\r\n          onChange={colorOnChange}\r\n          value={colorPickerState[0]}\r\n          step={1}\r\n          min={0}\r\n          max={255}\r\n        />\r\n        <ColorSlider\r\n          description=\"绿色(G):\"\r\n          id={5}\r\n          onChange={colorOnChange}\r\n          value={colorPickerState[1]}\r\n          step={1}\r\n          min={0}\r\n          max={255}\r\n        />\r\n        <ColorSlider\r\n          description=\"蓝色(B):\"\r\n          id={6}\r\n          onChange={colorOnChange}\r\n          value={colorPickerState[2]}\r\n          step={1}\r\n          min={0}\r\n          max={255}\r\n        />\r\n      </div>\r\n      <div className=\"inputFrame\">\r\n        <p className=\"fontSize\">\r\n          <b>配色方案名称 :</b>\r\n        </p>\r\n        <Input\r\n          placeholder=\"Please input the name of your scheme ~ \"\r\n          allowClear\r\n          value={name}\r\n          onChange={(event: any)=>{setName(event.target.value)}}\r\n        />\r\n        <br />\r\n        <br />\r\n        <p className=\"fontSize\">\r\n          <b>配色方案描述 :</b>\r\n        </p>\r\n        <TextArea\r\n          placeholder=\"Please input the description of your scheme ~ \"\r\n          rows={4}\r\n          allowClear\r\n          value={description}\r\n          onChange={(event: any)=>{setDescription(event.target.value)}}\r\n        />\r\n        <br />\r\n        <br />\r\n        <Button\r\n          type=\"primary\"\r\n          htmlType=\"submit\"\r\n          onClick={()=>{props.onSubmit(name, description);}}\r\n        >\r\n          提交\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ColorPicker;\r\n","import { useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { setConstantValue } from \"typescript\";\r\nimport { getColorState, getCreatorSketchId, getCurrColorIndex, getMainPageState, updateColorState, updateCurrColorIndex, updatePickerState } from \"../../../store\";\r\nimport ColorButton from \"./WorkSpace/ColorButton\";\r\nimport ColorPicker from \"./WorkSpace/ColorPicker\";\r\nimport Preview from \"./WorkSpace/Preview\";\r\n\r\n\r\ninterface ColorEditorProps {\r\n    sketch: string;\r\n    sketch_id: number;\r\n    initColorValue: Array<Array<number>>; // [[R, G, B, A, H, S, V] x n]\r\n    onSubmit: (sketch_id:number,name:string,discription:string,color_List:number[][])=>void;\r\n}\r\n\r\n\r\nconst ColorEditor = (props: ColorEditorProps) => {\r\n    const dispatch = useDispatch();\r\n    const [sketch, setSketch] = useState(props.sketch);\r\n    const colorState = useSelector(getColorState);\r\n    const currColorIndex = useSelector(getCurrColorIndex);\r\n    const currSketchId = useSelector(getCreatorSketchId);\r\n    const [init, setInit] = useState(0);\r\n    const mainPageState = useSelector(getMainPageState);\r\n    // const [colorState, setColorState] = useState<Array<Array<number>>>(props.initColorValue);\r\n    // const [currColorIndex, setCurrColorIndex] = useState<number>(0);\r\n\r\n\r\n    const onColorPickerColorChange = (newColorArray: Array<number>) => {\r\n        const newColorState = colorState.slice();\r\n        newColorState[currColorIndex] = newColorArray;\r\n        dispatch(updateColorState(newColorState))\r\n        // console.debug(colorState);\r\n        // console.debug(newColorState);\r\n    }\r\n\r\n    const buttonList = [] ;\r\n    const length = props.initColorValue.length;\r\n    for (let i = 0; i < length; ++i) {\r\n        buttonList.push(<ColorButton key={\"button-\"+i} id={i} onClick={()=>{dispatch(updateCurrColorIndex(i));} } color={colorState[i]} selected={currColorIndex === i}></ColorButton>)\r\n    }\r\n\r\n    useEffect(()=>{\r\n        dispatch(updateCurrColorIndex(0));\r\n        setSketch(mainPageState.sketchList.sketch_list.filter((sketch: any) => {return sketch.id === currSketchId})[0].data);\r\n        setInit(init+1);\r\n    }, [currSketchId]);\r\n\r\n    useEffect(()=>{\r\n        dispatch(updatePickerState(colorState[currColorIndex]));\r\n    }, [currColorIndex, init, currSketchId]);\r\n\r\n    useEffect(()=>{}, [props.sketch])\r\n\r\n    return (\r\n        <>\r\n        <div className=\"sketchPreview\">\r\n            <Preview raw_str={sketch} color_arr={colorState}></Preview>\r\n        </div>\r\n        <div className=\"colorToChoose\">{buttonList}</div>\r\n        <div className=\"ColorPicker\">\r\n            <ColorPicker initColor={colorState[currColorIndex]} colorOnChange={onColorPickerColorChange} onSubmit={(name: string, description: string)=>{props.onSubmit(props.sketch_id, name, description, colorState)}}></ColorPicker>\r\n        </div>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default ColorEditor;","const MD5 = function (string) {\r\n    function RotateLeft(lValue, iShiftBits) {\r\n        return (lValue<<iShiftBits) | (lValue>>>(32-iShiftBits));\r\n    }\r\n    function AddUnsigned(lX,lY) {\r\n        var lX4,lY4,lX8,lY8,lResult;\r\n        lX8 = (lX & 0x80000000);\r\n        lY8 = (lY & 0x80000000);\r\n        lX4 = (lX & 0x40000000);\r\n        lY4 = (lY & 0x40000000);\r\n        lResult = (lX & 0x3FFFFFFF)+(lY & 0x3FFFFFFF);\r\n        if (lX4 & lY4) {\r\n            return (lResult ^ 0x80000000 ^ lX8 ^ lY8);\r\n        }\r\n        if (lX4 | lY4) {\r\n            if (lResult & 0x40000000) {\r\n                return (lResult ^ 0xC0000000 ^ lX8 ^ lY8);\r\n            } else {\r\n                return (lResult ^ 0x40000000 ^ lX8 ^ lY8);\r\n            }\r\n        } else {\r\n            return (lResult ^ lX8 ^ lY8);\r\n        }\r\n    }\r\n    function F(x,y,z) { return (x & y) | ((~x) & z); }\r\n    function G(x,y,z) { return (x & z) | (y & (~z)); }\r\n    function H(x,y,z) { return (x ^ y ^ z); }\r\n    function I(x,y,z) { return (y ^ (x | (~z))); }\r\n    function FF(a,b,c,d,x,s,ac) {\r\n        a = AddUnsigned(a, AddUnsigned(AddUnsigned(F(b, c, d), x), ac));\r\n        return AddUnsigned(RotateLeft(a, s), b);\r\n    };\r\n    function GG(a,b,c,d,x,s,ac) {\r\n        a = AddUnsigned(a, AddUnsigned(AddUnsigned(G(b, c, d), x), ac));\r\n        return AddUnsigned(RotateLeft(a, s), b);\r\n    };\r\n    function HH(a,b,c,d,x,s,ac) {\r\n        a = AddUnsigned(a, AddUnsigned(AddUnsigned(H(b, c, d), x), ac));\r\n        return AddUnsigned(RotateLeft(a, s), b);\r\n    };\r\n    function II(a,b,c,d,x,s,ac) {\r\n        a = AddUnsigned(a, AddUnsigned(AddUnsigned(I(b, c, d), x), ac));\r\n        return AddUnsigned(RotateLeft(a, s), b);\r\n    };\r\n    function ConvertToWordArray(string) {\r\n        var lWordCount;\r\n        var lMessageLength = string.length;\r\n        var lNumberOfWords_temp1=lMessageLength + 8;\r\n        var lNumberOfWords_temp2=(lNumberOfWords_temp1-(lNumberOfWords_temp1 % 64))/64;\r\n        var lNumberOfWords = (lNumberOfWords_temp2+1)*16;\r\n        var lWordArray=Array(lNumberOfWords-1);\r\n        var lBytePosition = 0;\r\n        var lByteCount = 0;\r\n        while ( lByteCount < lMessageLength ) {\r\n            lWordCount = (lByteCount-(lByteCount % 4))/4;\r\n            lBytePosition = (lByteCount % 4)*8;\r\n            lWordArray[lWordCount] = (lWordArray[lWordCount] | (string.charCodeAt(lByteCount)<<lBytePosition));\r\n            lByteCount++;\r\n        }\r\n        lWordCount = (lByteCount-(lByteCount % 4))/4;\r\n        lBytePosition = (lByteCount % 4)*8;\r\n        lWordArray[lWordCount] = lWordArray[lWordCount] | (0x80<<lBytePosition);\r\n        lWordArray[lNumberOfWords-2] = lMessageLength<<3;\r\n        lWordArray[lNumberOfWords-1] = lMessageLength>>>29;\r\n        return lWordArray;\r\n    };\r\n    function WordToHex(lValue) {\r\n        var WordToHexValue=\"\",WordToHexValue_temp=\"\",lByte,lCount;\r\n        for (lCount = 0;lCount<=3;lCount++) {\r\n            lByte = (lValue>>>(lCount*8)) & 255;\r\n            WordToHexValue_temp = \"0\" + lByte.toString(16);\r\n            WordToHexValue = WordToHexValue + WordToHexValue_temp.substr(WordToHexValue_temp.length-2,2);\r\n        }\r\n        return WordToHexValue;\r\n    };\r\n    function Utf8Encode(string) {\r\n        string = string.replace(/\\r\\n/g,\"\\n\");\r\n        var utftext = \"\";\r\n        for (var n = 0; n < string.length; n++) {\r\n            var c = string.charCodeAt(n);\r\n            if (c < 128) {\r\n                utftext += String.fromCharCode(c);\r\n            }\r\n            else if((c > 127) && (c < 2048)) {\r\n                utftext += String.fromCharCode((c >> 6) | 192);\r\n                utftext += String.fromCharCode((c & 63) | 128);\r\n            }\r\n            else {\r\n                utftext += String.fromCharCode((c >> 12) | 224);\r\n                utftext += String.fromCharCode(((c >> 6) & 63) | 128);\r\n                utftext += String.fromCharCode((c & 63) | 128);\r\n            }\r\n        }\r\n        return utftext;\r\n    };\r\n    var x=Array();\r\n    var k,AA,BB,CC,DD,a,b,c,d;\r\n    var S11=7, S12=12, S13=17, S14=22;\r\n    var S21=5, S22=9 , S23=14, S24=20;\r\n    var S31=4, S32=11, S33=16, S34=23;\r\n    var S41=6, S42=10, S43=15, S44=21;\r\n    string = Utf8Encode(string);\r\n    x = ConvertToWordArray(string);\r\n    a = 0x67452301; b = 0xEFCDAB89; c = 0x98BADCFE; d = 0x10325476;\r\n    for (k=0;k<x.length;k+=16) {\r\n        AA=a; BB=b; CC=c; DD=d;\r\n        a=FF(a,b,c,d,x[k+0], S11,0xD76AA478);\r\n        d=FF(d,a,b,c,x[k+1], S12,0xE8C7B756);\r\n        c=FF(c,d,a,b,x[k+2], S13,0x242070DB);\r\n        b=FF(b,c,d,a,x[k+3], S14,0xC1BDCEEE);\r\n        a=FF(a,b,c,d,x[k+4], S11,0xF57C0FAF);\r\n        d=FF(d,a,b,c,x[k+5], S12,0x4787C62A);\r\n        c=FF(c,d,a,b,x[k+6], S13,0xA8304613);\r\n        b=FF(b,c,d,a,x[k+7], S14,0xFD469501);\r\n        a=FF(a,b,c,d,x[k+8], S11,0x698098D8);\r\n        d=FF(d,a,b,c,x[k+9], S12,0x8B44F7AF);\r\n        c=FF(c,d,a,b,x[k+10],S13,0xFFFF5BB1);\r\n        b=FF(b,c,d,a,x[k+11],S14,0x895CD7BE);\r\n        a=FF(a,b,c,d,x[k+12],S11,0x6B901122);\r\n        d=FF(d,a,b,c,x[k+13],S12,0xFD987193);\r\n        c=FF(c,d,a,b,x[k+14],S13,0xA679438E);\r\n        b=FF(b,c,d,a,x[k+15],S14,0x49B40821);\r\n        a=GG(a,b,c,d,x[k+1], S21,0xF61E2562);\r\n        d=GG(d,a,b,c,x[k+6], S22,0xC040B340);\r\n        c=GG(c,d,a,b,x[k+11],S23,0x265E5A51);\r\n        b=GG(b,c,d,a,x[k+0], S24,0xE9B6C7AA);\r\n        a=GG(a,b,c,d,x[k+5], S21,0xD62F105D);\r\n        d=GG(d,a,b,c,x[k+10],S22,0x2441453);\r\n        c=GG(c,d,a,b,x[k+15],S23,0xD8A1E681);\r\n        b=GG(b,c,d,a,x[k+4], S24,0xE7D3FBC8);\r\n        a=GG(a,b,c,d,x[k+9], S21,0x21E1CDE6);\r\n        d=GG(d,a,b,c,x[k+14],S22,0xC33707D6);\r\n        c=GG(c,d,a,b,x[k+3], S23,0xF4D50D87);\r\n        b=GG(b,c,d,a,x[k+8], S24,0x455A14ED);\r\n        a=GG(a,b,c,d,x[k+13],S21,0xA9E3E905);\r\n        d=GG(d,a,b,c,x[k+2], S22,0xFCEFA3F8);\r\n        c=GG(c,d,a,b,x[k+7], S23,0x676F02D9);\r\n        b=GG(b,c,d,a,x[k+12],S24,0x8D2A4C8A);\r\n        a=HH(a,b,c,d,x[k+5], S31,0xFFFA3942);\r\n        d=HH(d,a,b,c,x[k+8], S32,0x8771F681);\r\n        c=HH(c,d,a,b,x[k+11],S33,0x6D9D6122);\r\n        b=HH(b,c,d,a,x[k+14],S34,0xFDE5380C);\r\n        a=HH(a,b,c,d,x[k+1], S31,0xA4BEEA44);\r\n        d=HH(d,a,b,c,x[k+4], S32,0x4BDECFA9);\r\n        c=HH(c,d,a,b,x[k+7], S33,0xF6BB4B60);\r\n        b=HH(b,c,d,a,x[k+10],S34,0xBEBFBC70);\r\n        a=HH(a,b,c,d,x[k+13],S31,0x289B7EC6);\r\n        d=HH(d,a,b,c,x[k+0], S32,0xEAA127FA);\r\n        c=HH(c,d,a,b,x[k+3], S33,0xD4EF3085);\r\n        b=HH(b,c,d,a,x[k+6], S34,0x4881D05);\r\n        a=HH(a,b,c,d,x[k+9], S31,0xD9D4D039);\r\n        d=HH(d,a,b,c,x[k+12],S32,0xE6DB99E5);\r\n        c=HH(c,d,a,b,x[k+15],S33,0x1FA27CF8);\r\n        b=HH(b,c,d,a,x[k+2], S34,0xC4AC5665);\r\n        a=II(a,b,c,d,x[k+0], S41,0xF4292244);\r\n        d=II(d,a,b,c,x[k+7], S42,0x432AFF97);\r\n        c=II(c,d,a,b,x[k+14],S43,0xAB9423A7);\r\n        b=II(b,c,d,a,x[k+5], S44,0xFC93A039);\r\n        a=II(a,b,c,d,x[k+12],S41,0x655B59C3);\r\n        d=II(d,a,b,c,x[k+3], S42,0x8F0CCC92);\r\n        c=II(c,d,a,b,x[k+10],S43,0xFFEFF47D);\r\n        b=II(b,c,d,a,x[k+1], S44,0x85845DD1);\r\n        a=II(a,b,c,d,x[k+8], S41,0x6FA87E4F);\r\n        d=II(d,a,b,c,x[k+15],S42,0xFE2CE6E0);\r\n        c=II(c,d,a,b,x[k+6], S43,0xA3014314);\r\n        b=II(b,c,d,a,x[k+13],S44,0x4E0811A1);\r\n        a=II(a,b,c,d,x[k+4], S41,0xF7537E82);\r\n        d=II(d,a,b,c,x[k+11],S42,0xBD3AF235);\r\n        c=II(c,d,a,b,x[k+2], S43,0x2AD7D2BB);\r\n        b=II(b,c,d,a,x[k+9], S44,0xEB86D391);\r\n        a=AddUnsigned(a,AA);\r\n        b=AddUnsigned(b,BB);\r\n        c=AddUnsigned(c,CC);\r\n        d=AddUnsigned(d,DD);\r\n    }\r\n    var temp = WordToHex(a)+WordToHex(b)+WordToHex(c)+WordToHex(d);\r\n    return temp.toLowerCase();\r\n}\r\n\r\nexport default MD5;","import { message } from \"antd\";\r\nimport { WEB_URL } from \"../Settings\";\r\nimport MD5 from \"./MD5\";\r\n\r\n\r\nfunction getSessionId(): string{\r\n    // return \"9NCcToWtip7blkwuI1VmgPGXFBQnD2v8\"; // TODO: delete later\r\n    let sessionId=\"sessionId=\";\r\n    let cookie:string[]=document.cookie.split(';');\r\n    for(let i=0;i<cookie.length;i++){\r\n        let c=cookie[i].trim();\r\n        if(c.indexOf(\"sessionId\")===0) return c.substring(sessionId.length,c.length);\r\n    }\r\n    return \"\";\r\n}\r\n\r\n//升级至设计师\r\nfunction promptToDesigner(key: string): Promise<boolean> {\r\n    let md5: string = MD5(key);\r\n    let sessionId = getSessionId();\r\n    console.log(md5);\r\n\r\n    let parameter: string = JSON.stringify({ sessionId: sessionId, key: md5 });\r\n\r\n    console.log(parameter);\r\n    let urlbasic = WEB_URL;\r\n    let url: string = urlbasic + \"/api/userinfo\";\r\n\r\n    let result = fetch(url, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: parameter,\r\n    }).then((data) => {\r\n        return data.json();\r\n    }).then((json) => {\r\n        if (json.status === \"key verification failed\") {\r\n          return false;\r\n        } else {\r\n          return true;\r\n        }\r\n      });\r\n    return result;\r\n}\r\n\r\n//得到该用户提交的信息，返回一个字符串化的json\r\nfunction getUserScheme(studentid:string,sort_strategy:string):Promise<string>{\r\n    let sessionId:string=getSessionId();\r\n    let url:string=WEB_URL+\"/api/userScheme\"+\"?\"+\"sessionId=\"+sessionId+\"&student_id=\"+studentid+\"&sort_strategy=\"+sort_strategy;\r\n    let result=fetch(url).then(\r\n        resp=>{\r\n            return resp.json();\r\n        }\r\n    ).catch(()=>{message.error(\"网络开小差啦~\"); return {};});\r\n    return result;\r\n}\r\n\r\n//用户作出操作，返回一个字符串化的json\r\nfunction changeUserScheme(operation:string,recordId:number,color:number[][],recordName:string,descrption:string,author_Id:string,sketch_id:number):Promise<string>{\r\n    let sessionid=getSessionId();\r\n\r\n    let body=JSON.stringify(\r\n        {\r\n            operation:operation,\r\n            sessionId:sessionid,\r\n            id:recordId,\r\n            colors:color,\r\n            name:recordName,\r\n            description:descrption,\r\n            author_id:author_Id,\r\n            sketch_id:sketch_id\r\n        }\r\n    )\r\n    console.log(body);\r\n\r\n    let url=WEB_URL+\"/api/userScheme\"\r\n    let result=fetch(url,{\r\n        method: \"POST\",\r\n        headers: {\r\n            \"Content-Type\": 'application/json'\r\n        },\r\n        body: body\r\n    }).then(\r\n        resp=>{\r\n            return resp.json()\r\n        }\r\n    ).catch(()=>{message.error(\"网络开小差啦~\"); return {};})\r\n    return result;\r\n}\r\n\r\n//浏览信息的获取，返回一个字符串化的json，改成GET\r\nfunction getExploreScheme(sketch_id:number,sort_strategy:string,approved:boolean):Promise<any>{\r\n    let sessionid=getSessionId();\r\n    // let body=JSON.stringify({\r\n    //     sessionId:sessionid,\r\n    //     sketch_id:sketch_id,\r\n    //     sort_strategy:sort_strategy,\r\n    //     approved:approved\r\n    // })\r\n\r\n    let url=WEB_URL+\"/api/exploreScheme\"\r\n    url=url+\"?sessionId=\"+sessionid+\"&sketch_id=\"+sketch_id+\"&sort_strategy=\"+sort_strategy\r\n    if(approved){\r\n        url=url+\"&approved=1\"\r\n    }\r\n    let result=fetch(url).then(\r\n        resp=>{\r\n            return resp.json()\r\n        }\r\n    ).catch(()=>{message.error(\"网络开小差啦~\"); return {};})\r\n    return result\r\n}\r\n\r\n//线稿的列表\r\nfunction getSketch():Promise<string>{\r\n    let url=WEB_URL+\"/api/sketch\"\r\n    let result=fetch(url).then(\r\n        resp=>{\r\n            return resp.json()\r\n        }\r\n    ).catch(()=>{message.error(\"网络开小差啦~\"); return {};})\r\n    return result\r\n}\r\n\r\nexport { promptToDesigner, getUserScheme, changeUserScheme, getExploreScheme, getSketch, getSessionId };\r\n","import React from \"react\";\r\nimport {Col, message, Row, Switch} from 'antd';\r\nimport  { useState } from 'react';\r\nimport { Modal } from 'antd';\r\nimport '../../styles/Navbar.css';\r\nimport { Input } from 'antd';\r\nimport {FontAwesomeIcon} from \"@fortawesome/react-fontawesome\";\r\nimport {faPencilRuler, faRunning} from \"@fortawesome/free-solid-svg-icons\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { getMainPageState } from \"../../store\";\r\n\r\n// TODO: Beautify the navbar\r\n\r\ninterface TopBarProps{\r\n    readonly name:string;\r\n    readonly stateChangeFunction:(refresh: boolean)=>void;\r\n    readonly promptToDesigner:(value:string)=>Promise<boolean>;\r\n    readonly role:string;\r\n}\r\n\r\nfunction LoginOut(){\r\n    window.location.href = \"./logout\";\r\n}\r\n\r\ninterface AppProps{\r\n    readonly role:string;\r\n    readonly submit:(value:string)=>Promise<boolean>\r\n}\r\n\r\nconst App = (props:AppProps) => {\r\n    let role:string=props.role;\r\n    let submit:(value:string)=>Promise<boolean>=props.submit;\r\n    const [isModalVisible, setIsModalVisible] = useState(false);\r\n    const [key,setkey]=useState<string>();\r\n\r\n    const showModal = () => {\r\n        if(role===\"Designer\"){\r\n            message.info(\"您已经是设计师了！\");\r\n            return;\r\n        }\r\n        setIsModalVisible(true);\r\n    };\r\n\r\n    const handleOk = () => {\r\n        if(key){\r\n            submit(key).then(result=>{\r\n                if(!result){\r\n                    alert(\"邀请码错误\");\r\n                    return;\r\n                }else{\r\n                    setIsModalVisible(false);\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    const handleCancel = () => {\r\n        setIsModalVisible(false);\r\n    };\r\n\r\n    const valueChange=(value:string)=>{\r\n        setkey(value);\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <FontAwesomeIcon icon={ faPencilRuler } size={\"2x\"} onClick={showModal} />\r\n            <Modal title=\"注册成为设计师\" visible={isModalVisible} onOk={handleOk} onCancel={handleCancel}>\r\n                <p>请输入注册邀请码</p>\r\n                <Input placeholder=\"Basic usage\" id=\"keyText\" value={key} onChange={event=>{valueChange(event.target.value)}}/>\r\n            </Modal>\r\n        </>\r\n    );\r\n};\r\n\r\n\r\n//顶栏\r\nconst TopBar = (props: TopBarProps) => {\r\n\r\n    const mainPageState = useSelector(getMainPageState);\r\n\r\n    return(\r\n        <div className=\"Navbar\"> 123 </div>\r\n        // <Row justify=\"space-around\" align={\"middle\"}>\r\n        //     <Col span={4} style={{height:\"73px\"}} >\r\n        //         <p >欢迎，{props.name}</p>\r\n        //     </Col>\r\n        //     <Col span={13}>\r\n        //     </Col>\r\n        //     <Col span={2} style={{height:\"73px\"}}>\r\n        //         <Switch  checkedChildren=\"创作\" unCheckedChildren=\"浏览\" checked={mainPageState.page === 'Creator'} onChange={()=>{props.stateChangeFunction(false);}}/>\r\n        //     </Col>\r\n        //     <Col span={1.25}>\r\n        //         <App role={props.role} submit={props.promptToDesigner} />\r\n        //     </Col>\r\n        //     <Col span={1.25} onClick={LoginOut}>\r\n        //         <Row style={{height:\"3px\", paddingLeft:\"16px\"}} align={\"middle\"}>\r\n        //             <FontAwesomeIcon icon={ faRunning} size={\"2x\"} />\r\n        //         </Row>\r\n        //         <Row style={{height:\"38px\"}} align={\"middle\"}>\r\n        //             退出登录\r\n        //         </Row>\r\n        //     </Col>\r\n        // </Row>\r\n    );\r\n}\r\n\r\nexport default TopBar;","import { Layout, message } from \"antd\";\r\nimport { Content } from \"antd/lib/layout/layout\";\r\nimport Modal from \"antd/lib/modal/Modal\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { WEB_URL } from \"../../Settings\";\r\nimport { getMainPageState, updateMainPageState } from \"../../store\";\r\nimport { changeUserScheme, getExploreScheme, getSessionId, getSketch, promptToDesigner } from \"../../utils/Network\";\r\nimport Creator from \"../Creator/Creator\";\r\nimport Explorer from \"../Explorer/Explorer\";\r\nimport HistoryList from \"../HistoryList/HistoryList\";\r\nimport Navbar from \"../Navbar/Navbar\";\r\n\r\n\r\nvar submittedIn30s = false;\r\n\r\nconst MainPage = () => {\r\n\r\n    message.config({\r\n        maxCount: 2,\r\n    });\r\n\r\n    const mainPageState = useSelector(getMainPageState);\r\n    const dispatch = useDispatch();\r\n    const [updatePage, setUpdatePage] = useState(0);\r\n\r\n    // Operations\r\n\r\n    // Click sorting\r\n    const changeSort = (type: string, approvedOnly=false) : void => {\r\n        // if(mainPageState.userInfo.role === 'Designer') {\r\n        const currApprovedOnly = mainPageState.misc.approved;\r\n        if (approvedOnly) {\r\n            // Switch\r\n            getExploreScheme(0,mainPageState.misc.sortStrategy,!currApprovedOnly).then(\r\n                resp=>{\r\n                    const newMisc = JSON.parse(JSON.stringify(mainPageState.misc));\r\n                    newMisc.approved = !currApprovedOnly;\r\n                    dispatch(updateMainPageState({misc: newMisc, schemeList: resp}));\r\n                }\r\n            );\r\n        } else {\r\n            getExploreScheme(0,type,currApprovedOnly).then(\r\n                resp=>{\r\n                    const newMisc = JSON.parse(JSON.stringify(mainPageState.misc));\r\n                    newMisc.sortStrategy = type;\r\n                    dispatch(updateMainPageState({misc: newMisc, schemeList: resp}));\r\n                }\r\n            )\r\n        }\r\n\r\n        // } else if (mainPageState.userInfo.role === 'User') {\r\n        //     getUserScheme(mainPageState.userInfo.student_id, type).then(\r\n        //         resp=>{\r\n        //             const newMisc = JSON.parse(JSON.stringify(mainPageState.misc));\r\n        //             newMisc.sortStrategy = type;\r\n        //             dispatch(updateMainPageState({misc: newMisc, schemeList: resp}));\r\n        //         }\r\n        //     )\r\n        // }\r\n    };\r\n\r\n\r\n    // Deletion\r\n    const deleteRecord = (id: number) => {\r\n        changeUserScheme(\"delete\",id,[],\"\",\"\",\"\",0).then(\r\n            resp=>{changeSort(mainPageState.misc.sortStrategy);}\r\n        )\r\n    };\r\n\r\n    // Approve\r\n    const approveOperation = (id:number): void => {\r\n        if( mainPageState.userInfo.role === \"User\" ) return;\r\n        changeUserScheme(\"approve\",id,[],\"\",\"\",\"\",0).then(\r\n            resp=>{changeSort(mainPageState.misc.sortStrategy);}\r\n        )\r\n    }\r\n\r\n    // Disapprove\r\n    const disapproveOperation = (id:number): void => {\r\n        if( mainPageState.userInfo.role === \"User\" ) return;\r\n        changeUserScheme(\"disapprove\",id,[],\"\",\"\",\"\",0).then(\r\n            resp=>{changeSort(mainPageState.misc.sortStrategy);}\r\n        )\r\n    }\r\n\r\n    // Submission\r\n    const submitRecord = (sketch_id:number,name:string,description:string,color_List:number[][]):void => {\r\n        if(name === '') { message.error(\"请输入配色方案名称!\"); return;}\r\n        if(submittedIn30s){\r\n            message.info(\"您的提交过于频繁，请稍后！\");\r\n        }else{\r\n            changeUserScheme(\"create\",0,color_List,name,description,mainPageState.userInfo.student_id,sketch_id).then(\r\n                (resp: any)=>{\r\n                    if(resp.err === 'similar') {\r\n                        message.error(\"请不要提交与已有方案类似的方案!\")\r\n                    } else if (resp.err === 'name duplicated') {\r\n                        message.error(\"请不要提交重名方案!\")\r\n                    } else {\r\n                        message.info(\"提交成功\");\r\n                        changeSort(mainPageState.misc.sortStrategy);\r\n                        submittedIn30s = true;\r\n                        setTimeout(()=>{\r\n                            submittedIn30s = false;\r\n                        },30000);\r\n                    }\r\n\r\n                }\r\n            )\r\n        }\r\n    }\r\n\r\n    //点击历史记录色条跳转到浏览界面\r\n    const exploreOperation = (id:number):void => {\r\n        const schemeList = mainPageState.schemeList.schemes;\r\n        const filtered = schemeList.filter((scheme: any) => {return scheme.id===id});\r\n        if (filtered.length === 0) return;\r\n\r\n        // 更改 exploreScheme 的信息 然后跳转过去\r\n        dispatch(updateMainPageState({exploreScheme: filtered[0]}));\r\n        switchPage(false);\r\n        // eslint-disable-next-line no-restricted-globals\r\n        \r\n    }\r\n\r\n    \r\n\r\n    //刷新随机浏览界面\r\n    const refreshExplore = () : void => {\r\n        getExploreScheme(0, 'submission_time', false).then(\r\n            resp=>{\r\n                // TODO: 校验正确性\r\n                // TODO: 使用获得的 scheme 更新全局变量的 exploreScheme 的值\r\n                const schemeList = resp.schemes;\r\n                // Generate a random number between [0, schemeList.length)\r\n                const randomIndex = Math.floor(Math.random() * schemeList.length);\r\n                const newScheme = schemeList[randomIndex];\r\n\r\n                dispatch(updateMainPageState({exploreScheme: newScheme}));\r\n\r\n            }\r\n        )\r\n    }\r\n\r\n\r\n\r\n    //切换界面\r\n    const switchPage = (refresh: boolean) => {\r\n        if(refresh) {refreshExplore();}\r\n        dispatch(updateMainPageState({page: mainPageState.page === 'Creator' ? 'Explore' : 'Creator'}));\r\n    }\r\n\r\n    // The first time the page is rendered...\r\n    useEffect(()=>{\r\n        fetch(WEB_URL + \"/api/userinfo?sessionId=\" + getSessionId(),).then(resp =>resp.json()).then(\r\n            json=>{\r\n                \r\n                if(json.err){ \r\n                    // TODO: 返回登录界面    \r\n                    return; \r\n                }\r\n                const userInfo = {\r\n                    loggedIn: true,\r\n                    student_id: json.student_id,\r\n                    name: json.name,\r\n                    fullname: json.fullname,\r\n                    email: json.email,\r\n                    role: json.role,\r\n                };\r\n                dispatch(updateMainPageState({userInfo}));\r\n                \r\n                \r\n                // Get user schemes\r\n                // if( json.role === 'Designer' ) {\r\n                getExploreScheme(0,\"submission_time\",false).then(\r\n                    resp=>{\r\n                        dispatch(updateMainPageState({schemeList: resp, exploreScheme: resp.schemes.length > 0 ? resp.schemes[0] : undefined}));\r\n                });\r\n                // }\r\n                // else if (json.role === 'User') {\r\n                //     getUserScheme(mainPageState.userInfo.student_id,\"submission_time\").then(\r\n                //         resp=>{\r\n                //             dispatch(updateMainPageState({schemeList: resp}));\r\n                //         }\r\n                //     )\r\n                // }\r\n\r\n                // Get sketch list\r\n                getSketch().then(resp=>{\r\n                    dispatch(updateMainPageState({sketchList: resp})); \r\n                })\r\n            }\r\n        ).catch(()=>{message.error(\"网络开小差啦~\"); return {};})\r\n    }, []);\r\n\r\n    useEffect(()=>{\r\n        setUpdatePage(updatePage+1);\r\n    }, [mainPageState])\r\n\r\n    return (\r\n        <main>\r\n            <Navbar \r\n              name={mainPageState.userInfo.name} \r\n              role={mainPageState.userInfo.role}\r\n              stateChangeFunction={switchPage}\r\n              promptToDesigner={promptToDesigner}\r\n              />\r\n            <Layout>\r\n                <Content style={{ margin: \"50px auto\" }}>\r\n                    <div className=\"Creator\">\r\n                        <Creator\r\n                            sketch={JSON.stringify(mainPageState.sketchList)}\r\n                            onSubmit={submitRecord} \r\n                        />\r\n                        <HistoryList\r\n                            disapprove={disapproveOperation}\r\n                            sort={changeSort}\r\n                            getString={JSON.stringify(mainPageState.schemeList)}\r\n                            show_select={mainPageState.userInfo.role === 'Designer'}\r\n                            approve={approveOperation}\r\n                            delete={deleteRecord}\r\n                            explore={exploreOperation} \r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"Explore\">\r\n                        <Modal \r\n                            title={mainPageState.exploreScheme.name}\r\n                            centered\r\n                            visible={mainPageState.page === 'Explore'}\r\n                            onCancel={() => {\r\n                                switchPage(false);\r\n                            }}\r\n                            footer={null}\r\n                        >\r\n                            <Explorer></Explorer>\r\n                        </Modal>\r\n                    </div>\r\n\r\n                    {/* <div className=\"Explore\" style={{display: mainPageState.page === 'Explore' ? '' : 'none'}}>\r\n                        <Row justify={\"space-around\"} align={\"middle\"}>\r\n                            <Preview raw_str={getExploreRawSvg()} color_arr={mainPageState.exploreScheme.colors}/>\r\n                        </Row>\r\n                        <InterActiveInExploration vote={vote} unvote={unvote} liked={mainPageState.exploreScheme.liked} next={next} edit={edit} />\r\n                    </div> */}\r\n                </Content>\r\n            </Layout>\r\n        </main>\r\n    );\r\n};\r\n\r\nexport default MainPage;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './styles/index.css';\r\nimport { Provider } from 'react-redux';\r\nimport store from './store';\r\nimport MainPage from './components/MainPage/MainPage';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <Provider store={store}>\r\n      <MainPage />\r\n    </Provider>\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);","// HSV => RGB\r\nconst HSV2RGB = (colorValueListBak: Array<number>):Array<number> => {\r\n    // console.log(\"-------------------------in HSV 2 RGB----------------------------\");\r\n    let R: number = colorValueListBak[4]/255, G: number = colorValueListBak[5]/255, B: number = colorValueListBak[6]/255;\r\n    let H: number = colorValueListBak[0], S: number = colorValueListBak[1], V: number = colorValueListBak[2];\r\n    let h: number = Math.floor(H / 60);\r\n    let f: number = H / 60 - h, p = V * (1 - S), q = V * (1 - f * S), t = V * (1 - (1 - f) * S);\r\n    switch (h) {\r\n        case 0:\r\n            R = V; G = t; B = p;\r\n            break;\r\n        case 1:\r\n            R = q; G = V; B = p;\r\n            break;\r\n        case 2:\r\n            R = p; G = V; B = t;\r\n            break;\r\n        case 3:\r\n            R = p; G = q; B = V;\r\n            break;\r\n        case 4:\r\n            R = t; G = p; B = V;\r\n            break;\r\n        case 5:\r\n            R = V; G = p; B = q;\r\n            break;\r\n    }\r\n    // 从 [0, 1] 转换到 [0, 255]\r\n    R *= 255; G *= 255; B *= 255;\r\n    // 更新状态\r\n    colorValueListBak[4] = parseFloat(R.toFixed(0));\r\n    colorValueListBak[5] = parseFloat(G.toFixed(0));\r\n    colorValueListBak[6] = parseFloat(B.toFixed(0));\r\n    // 调试输出\r\n    // for(let i = 0; i <= 6; i++){\r\n    //     console.log(colorValueListBak[i] + \" \");\r\n    // }\r\n    return colorValueListBak;\r\n}\r\n// RGB => HSV\r\nconst RGB2HSV = (colorValueListBak: Array<number>):Array<number> => {\r\n    // console.log(\"-------------------------in RGB 2 HSV----------------------------\");\r\n    let H: number = colorValueListBak[0], S: number, V: number;\r\n    let R: number = colorValueListBak[4]/255, G: number = colorValueListBak[5]/255, B: number = colorValueListBak[6]/255;\r\n    let colorMax = getMax(R, G, B), colorMin = getMin(R, G, B), delta = colorMax - colorMin;\r\n    // 计算 H\r\n    if (delta === 0){\r\n        H = 0;\r\n    }\r\n    else if (colorMax === R && G >= B){\r\n        H = 60 * ((G - B) / delta);\r\n    }\r\n    else if (colorMax === R && G < B){\r\n        H = 60 * ((G - B) / delta) + 360;\r\n    }\r\n    else if (colorMax === G){\r\n        H = 60 * ((B - R) / delta) + 120;\r\n    }\r\n    else if (colorMax === B){\r\n        H = 60 * ((R - G) / delta) + 240;\r\n    }\r\n    // 计算 V\r\n    V = colorMax;\r\n    // 计算 S\r\n    S = (colorMax === 0) ? 0 : (1 - colorMin / colorMax);\r\n    // console.log(\"H: \" + H + \" S: \" + S + \" V: \" + V + \" R: \" + R + \" G: \" + G + \" B: \" + B);\r\n    // 更新状态\r\n    colorValueListBak[0] = parseFloat(H.toFixed(0));\r\n    colorValueListBak[1] = parseFloat(S.toFixed(2));\r\n    colorValueListBak[2] = parseFloat(V.toFixed(2));\r\n    // 调试输出\r\n    // for(let i = 0; i <= 6; i++){\r\n    //     console.log(colorValueListBak[i] + \" \");\r\n    // }\r\n    return colorValueListBak;\r\n}\r\n// 获取三个数的最大值\r\nconst getMax = (a: number, b: number, c: number) => {\r\n    let max = a;\r\n    if(max < b)\r\n        max = b;\r\n    if(max < c)\r\n        max = c;\r\n    return max;\r\n}\r\n// 获取三个数的最小值\r\nconst getMin = (a: number, b: number, c: number) => {\r\n    let min = a;\r\n    if(min > b)\r\n        min = b;\r\n    if(min > c)\r\n        min = c;\r\n    return min;\r\n}\r\n\r\nconst String2ArrayRGB = (colorHexString: string):Array<number> => {\r\n    let R = parseInt(colorHexString.substring(1, 3), 16), G = parseInt(colorHexString.substring(3, 5), 16), B = parseInt(colorHexString.substring(5, 7), 16);\r\n    return [R, G, B];\r\n}\r\n\r\nexport {RGB2HSV, HSV2RGB, String2ArrayRGB};","/*\r\n    Configuration file.\r\n*/\r\n\r\nconst WEB_URL = \"http://192.168.137.1:8000\";\r\n\r\nexport {WEB_URL};","import React from \"react\";\r\nimport { Tooltip } from \"antd\";\r\n\r\ninterface preview_props {\r\n    readonly raw_str: string; // svg字符串\r\n    readonly color_arr: any; // 二维数组\r\n}\r\n\r\nclass Preview extends React.Component<preview_props, any>{\r\n    render() {\r\n        let color_saved = [];\r\n        color_saved.push(\"\");\r\n        let my_color = this.props.color_arr; // [RGBAHSV]\r\n        let color_num;\r\n\r\n        color_num = my_color.length;\r\n        for (let i = 0; i < color_num; i++){\r\n            let tmp = \"rgba(\" + my_color[i][0] + \",\" + my_color[i][1] + \",\" + my_color[i][2] + \",\" + my_color[i][3] + \")\";\r\n            tmp = \"fill=\" + '\"' + tmp + '\" opacity=' + my_color[i][3];\r\n            color_saved.push(tmp);\r\n        }\r\n\r\n        let s = this.props.raw_str;\r\n        for (let i = 1; i <= color_num; i++) {\r\n            let tmp = \"%%\" + i.toString() + \"%%\";\r\n            s = s.replaceAll(tmp, color_saved[i]);\r\n        }\r\n\r\n        return (\r\n            \r\n            <div className={\"preview_svg\"}>\r\n                <div style={{display: 'flex', justifyContent:'center'}} dangerouslySetInnerHTML={{__html: s}}/>\r\n            </div>\r\n        )\r\n    }\r\n\r\n}\r\n\r\nexport default Preview;"],"sourceRoot":""}